ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 0.25, center = 0, fill = "grey50", size = 1, binwidth = 50) +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey50", size = 1) +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = 2) +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "2") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey40") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25", size = 1.25) +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1.25, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1.1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "teal", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "lightblue", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "blue", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "#B51A62", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
score <- as.numeric(input[[var]])
score
input[[var]]
var
input$ppltrst <- 5
score <- as.numeric(input[[var]])
data <- ess_data
data$frprtpl <- (data$frprtpl - 1)
data$impcntr <- (3 - (data$impcntr - 1))
data$imsmetn <- (3 - (data$imsmetn - 1))
data$imdfetn <- (3 - (data$imdfetn - 1))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "#B51A62", lwd = 2) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
runApp()
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "#B51A62", lwd = 3) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data %>% subset(cntry %in% hdata)) +
geom_histogram(aes(x = .data[[var]]), binwidth = 1, center = 0, fill = "grey80", size = 1, col = "grey25") +
geom_vline(xintercept = score, col = "#B51A62", lwd = 4) +
scale_x_continuous(breaks = seq(0, 10, by = 1)) +
ylab("Number of responses") +
xlab(expss::recode(var,
"ppltrst" ~ "Trust in people",
"pplfair" ~ "Fairness of people",
"pplhlp" ~ "Helpfulness of people",
"trstprl" ~ "Trust in own country's parliament",
"trstep" ~ "Trust in European Parliament",
"trstlgl" ~ "Trust in own country's legal system",
"imbgeco" ~ "Immigration perception (economic)",
"imueclt" ~ "Immigration perception (cultural)",
"imwbcnt" ~ "Don't know",
"impcntr" ~ "Immigration attitude (poorer countries outside of Europe)",
"imsmetn" ~ "Immigration attitude (same race)",
"imdfetn" ~ "Immigration attitude (different race)",
"happy"   ~ "General happness",
"stflife" ~ "Satisfaction with life",
"frprtpl" ~ "Don't know",
"stfdem"  ~ "Satisfaction with democracy",
"stfeco"  ~ "Satisfaction with economy",
"stfedu"  ~ "Satisfaction with education system",
"stfhlth" ~ "Satisfaction with healthcare",
"lrscale" ~ "Self placement on left-right scale")) +
ggtitle(variable_questions[[input$histvar]]) +
theme(plot.title = element_text(hjust = 0.5))
