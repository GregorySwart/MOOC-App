)}, # Trust
{fluidPage(
fluidRow(
column(12, align = "center",
h1("Immigration"),
br(),
br()
)
),
fluidRow(
column(10, offset = 1,
p("Two indicators were derived from variables dealing with immigration: Immigration
Perception, and Immigration Rejection. (Immigration Racial?) Immigration Perception
refers to the percieved good or bad effects immigration has in the eyes of its
residents, calculated by taking the average of the varaibles imbgeco, imueclt, imwbcnt.
Immigration rejection refers to the proportion of people who answered \"Allow none.\" to
the question \"How many immigrants would you allow to come and live in your country from
poorer countries outside of europe?\".")
)
),
fluidRow(
column(1),
column(6,
plotOutput("radar_immigration", height = 800, width = "auto")
),
column(1,
plotOutput("immigration_perception", height = 800, width = 90)
),
column(1,
plotOutput("immigration_rejection", height = 800, width = 90)
),
column(2, align = "center",
selectInput("cntry_immigration", "Country (not implemented)",
choices = list("Hungary" = "HU", "United Kingdom" = "UK"),
selected = "Hungary"),
checkboxInput("EU_check_immigration", label = "Hide EU median"),
checkboxInput("HU_check_immigration", label = "Hide HU median"),
checkboxInput("own_check_immigration", label = "Hide own score", value = TRUE),
actionButton("redraw_immigration", "Update plot")),
column(1)
),
fluidRow(
hr()
)
)}, # Immigration
{fluidPage(
fluidRow(
column(12, align = "center",
h1("Satisfaction"),
br(),
br()
)
),
fluidRow(
column(10, offset = 1,
p("Three satisfaction indicators were derived from the data. Subjective Satisfaction
is the average value of the variables happiness and satisfaction in life. Political
Satisfaction in the average value of the variables frprtpl (Political system in country
allows all to participate freely and equally in politics) and satisfaction with how
democracy works. Institutional Satisfaction is the average of the variables stfeco
(satisfaction with democracy in own country), stfedu (satistaction with education system),
and atfhlth (satisfaction with healthcare system). All variables have range 0-10.")
)
),
fluidRow(
column(1),
column(5,
plotOutput("radar_satisfaction", height = 800, width = "auto")
),
column(1,
plotOutput("Subjective_Satisfaction", height = 800, width = 90)
),
column(1,
plotOutput("Political_Satisfaction", height = 800, width = 90)
),
column(1,
plotOutput("Institutional_Satisfaction", height = 800, width = 90)
),
column(2, align = "center",
selectInput("cntry_satisfaction", "Country (not implemented)",
choices = list("Hungary" = "HU", "United Kingdom" = "UK"),
selected = "Hungary"),
checkboxInput("EU_check_satisfaction", label = "Hide EU median"),
checkboxInput("HU_check_satisfaction", label = "Hide HU median"),
checkboxInput("own_check_satisfaction", label = "Hide own score", value = TRUE),
actionButton("redraw_satisfaction", "Update plot")),
column(1)
),
fluidRow(
hr()
)
)}  # Satisfaction
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
deployApp()
shiny::runApp()
shiny::runApp()
library(rsconnect)
deployApp()
library(foreign)
library(dplyr)
library(ggplot2)
library(expss)
library(gdata)
library(survey)
ESS9 <- as.data.frame(read.spss("ESS9.sav")) %>%
select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif,freehms,hmsfmlsh,hmsacld)
ESS9$agea <- as.numeric(as.character(ESS9$agea))
ESS9 <- na.omit(ESS9)
ESS9$homophobia <- recode(ESS9$freehms, "Agree strongly" ~ 0, "Agree" ~ 1, "Neither agree nor disagree" ~ 2,
"Disagree"~3,"Disagree strongly" ~ 4)
unique(ESS9$homophobia)
ESS9$homophobia <- as.numeric(as.character(ESS9$homophobia))
unique(ESS9$freehms)
{ESS9$inc <- recode(ESS9$gincdif, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$living <- recode(ESS9$freehms, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$shame <- recode(ESS9$hmsfmlsh, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$adoption <- recode(ESS9$hmsacld, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
unique(drop.levels(ESS9$cntry, reorder = F))
ggplot(ESS9, mapping = aes(x = inc, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3) +
labs(title = "The government should take measures to reduce differences in income levels.")
ggplot(ESS9, mapping = aes(x = living, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3)+
labs(title = "Gay men and lesbians should be free to live their own life as they wish.")
ggplot(ESS9, mapping = aes(x = shame, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3) +
labs(title = "If a close family member was a gay man or a lesbian, I would feel ashamed.")
ggplot(ESS9, mapping = aes(x = adoption, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3)+
labs(title = "Gay male and lesbian couples should have the same rights to adopt children as straight couples.")
} # Plots
d <- svydesign(ids = ~1, data = ESS9, weights = ESS9$dweights)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d)
summary(model1)
# I separated adoption into three categories, as in some countries only partial adoption is in place, meaning that
# a couple can only adopt a child if they are the biological child of one of the parties.
ESS9$adoption_law <- factor(1, levels = c(1,2,3))
ESS9$adoption_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
ESS9$adoption_law[which(ESS9$cntry %in% c("Belgium","Denmark","Finland","France",
"Netherlands","Sweden"))] <- 3
unique(ESS9$adoption_law)
unique(ESS9$cntry)
which(ESS9$cntry == "Croatia")
model2 <- svyglm(homophobia~adoption_law+agea+gndr, design = d)
View(ESS9)
View(ESS9)
unique(ESS9$adoption_law)
model2 <- svyglm(homophobia~agea+gndr, design = d)
d <- svydesign(ids = ~1, data = ESS9, weights = ESS9$dweights)
model2 <- svyglm(homophobia~adoption_law+agea+gndr, design = d)
summary(model2)
ESS9 <- as.data.frame(read.spss("ESS9.sav"))
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
lrscale,
freehms,hmsfmlsh,hmsacld)
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vole, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
{
ESS9 <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif,freehms,hmsfmlsh,hmsacld)
ESS9$agea <- as.numeric(as.character(ESS9$agea))
ESS9 <- na.omit(ESS9)
ESS9$homophobia <- recode(ESS9$freehms, "Agree strongly" ~ 0, "Agree" ~ 1, "Neither agree nor disagree" ~ 2,
"Disagree"~3,"Disagree strongly" ~ 4)
unique(ESS9$homophobia)
ESS9$homophobia <- as.numeric(as.character(ESS9$homophobia))
unique(ESS9$freehms)
{ESS9$inc <- recode(ESS9$gincdif, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$living <- recode(ESS9$freehms, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$shame <- recode(ESS9$hmsfmlsh, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
ESS9$adoption <- recode(ESS9$hmsacld, "Agree strongly" ~ "AS", "Agree"~"A", "Neither agree nor disagree" ~ "NE",
"Disagree" ~ "D", "Disagree strongly" ~ "DS", "Don't know" ~ "DK",
"Refusal" ~ "RF", "No answer" ~ "NA") %>% drop.levels(reorder = F)
unique(drop.levels(ESS9$cntry, reorder = F))
ggplot(ESS9, mapping = aes(x = inc, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3) +
labs(title = "The government should take measures to reduce differences in income levels.")
ggplot(ESS9, mapping = aes(x = living, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3)+
labs(title = "Gay men and lesbians should be free to live their own life as they wish.")
ggplot(ESS9, mapping = aes(x = shame, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3) +
labs(title = "If a close family member was a gay man or a lesbian, I would feel ashamed.")
ggplot(ESS9, mapping = aes(x = adoption, fill = gndr)) +
geom_bar() +
facet_wrap(~cntry, nrow = 3)+
labs(title = "Gay male and lesbian couples should have the same rights to adopt children as straight couples.")
} # Plots
d <- svydesign(ids = ~1, data = ESS9, weights = ESS9$dweights)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d)
summary(model1)
# I separated adoption into three categories, as in some countries only partial adoption is in place, meaning that
# a couple can only adopt a child if they are the biological child of one of the parties.
ESS9$adoption_law <- factor(1, levels = c(1,2,3))
ESS9$adoption_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
ESS9$adoption_law[which(ESS9$cntry %in% c("Belgium","Denmark","Finland","France",
"Netherlands","Sweden"))] <- 3
unique(ESS9$adoption_law)
unique(ESS9$cntry)
which(ESS9$cntry == "Croatia")
d <- svydesign(ids = ~1, data = ESS9, weights = ESS9$dweights)
model2 <- svyglm(homophobia~adoption_law+agea+gndr, design = d)
summary(model2)
# Model 2 shows that there is a significant relationship between homophobia (freehms) and adoption laws
ESS9$partnership_law <- factor(0, levels = c(0,1,2))
ESS9$partnership_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
}
cor(data$stfgov, data$stfdem)
data$stfgov
recode(data$stfdem, "Extremely dissatisfied" ~ 0, "Extremely satisfied" ~ 10)
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
ESS9 <- as.data.frame(read.spss("ESS9.sav"))
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d1)
recode(data$stfdem, "Extremely dissatisfied" ~ 0, "Extremely satisfied" ~ 10)
data$stfdem
recode(data$stfdem, "Extremely dissatisfied" ~ 0, "Extremely satisfied" ~ 10) = data$stfdem
recode(data$stfdem, "Extremely dissatisfied" ~ 0, "Extremely satisfied" ~ 10) <- data$stfdem
recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <-  recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <- as.numeric(as.character(data$stfdem))
data$stfgov <- recode(data$stfgov, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfgov <- as.numeric(as.character(data$stfdem))
data$stfdem
unique(stfdem)
unique(data$stfdem)
cor(data$stfgov, data$stfdem)
data <- data %>% na.omit()
data %>% select(stfdem, stfgov)
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
data$stfdem <-  recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <- as.numeric(as.character(data$stfdem))
data$stfgov <- recode(data$stfgov, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfgov <- as.numeric(as.character(data$stfdem))
pol <- data %>% select(stfdem, stfgov) %>% na.omi
pol <- data %>% select(stfdem, stfgov) %>% na.omit()
cor(data$stfgov, data$stfdem)
cor(pol$stfgov, pol$stfdem)
cor(pol$stfgov, pol$stfdem)
pol <- data %>% select(stfdem, stfgov) %>% na.omit()
View(pol)
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d1)
data$stfdem <-  recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <- as.numeric(as.character(data$stfdem))
data$stfgov <- recode(data$stfgov, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfgov <- as.numeric(as.character(data$stfgov))
pol <- data %>% select(stfdem, stfgov) %>% na.omit()
cor(pol$stfgov, pol$stfdem)
View(data)
recode(data$freehms, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F)
recode(data$freehms, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
recode(data$hmsfmlsh, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
recode(data$hmsacld, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
View(data)
data$freehms <- recode(data$freehms, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsfmlsh <- recode(data$hmsfmlsh, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsacld <- recode(data$hmsacld, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
View(data)
model <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
summary(model)
data$agea <- data$agea %>% as.character() %>% as.numeric()
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
summary(model)
model1 <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
data$adoption_law <- factor(1, levels = c(1,2,3))
data$adoption_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
data$adoption_law[which(ESS9$cntry %in% c("Belgium","Denmark","Finland","France",
"Netherlands","Sweden"))] <- 3
data$adoption_law <- data$adoption_law %>% as.character() %>% as.numeric()
unique(data$adoption_law)
hundata <- data %>% subset(cntry == "Hungary")
d2 <- svydesign(ids = ~1, data = hundata, weights = hundata$dweights)
ESS9 <- as.data.frame(read.spss("ESS9.sav"))
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model1 <- svyglm(homophobia~agea+gndr+cntry, design = d1)
data$stfdem <-  recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <- as.numeric(as.character(data$stfdem))
data$stfgov <- recode(data$stfgov, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfgov <- as.numeric(as.character(data$stfgov))
pol <- data %>% select(stfdem, stfgov) %>% na.omit()
cor(pol$stfgov, pol$stfdem) # 0.6774865 correlation
data$freehms <- recode(data$freehms, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsfmlsh <- recode(data$hmsfmlsh, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsacld <- recode(data$hmsacld, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$agea <- data$agea %>% as.character() %>% as.numeric()
data$adoption_law <- factor(1, levels = c(1,2,3))
data$adoption_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
data$adoption_law[which(ESS9$cntry %in% c("Belgium","Denmark","Finland","France",
"Netherlands","Sweden"))] <- 3
data$adoption_law <- data$adoption_law %>% as.character() %>% as.numeric()
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
hundata <- data %>% subset(cntry == "Hungary")
d2 <- svydesign(ids = ~1, data = hundata, weights = hundata$dweights)
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
model_shame_hu <- svyglm(hmsfmlsh ~ agea + gndr  + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_shame_hu)
model_adoption_hu <- svyglm(hmsacld ~ agea + gndr + eisced + domicil + rlgblg + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_adoption_hu)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
`%nin%` <- Negate(`%in%`)
data <- data %>% subset(lrscale %nin% c("Refusal", "Don't know", "No answer"))
data <- data %>% subset(eisced %nin% c("Other", "Refusal", "Don't know", "No answer"))
data <- data %>% subset(domicil %nin% c("Refusal", "Don't know", "No answer"))
data <- data %>% subset(rlgatnd %nin% c("Refusal", "Don't know", "No answer"))
data <- data %>% subset(lrscale %nin% c("Refusal", "Don't know", "No answer"))
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
model_shame <- svyglm(hmsfmlsh ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_shame)
model_adoption <- svyglm(hmsacld ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_adoption)
hundata <- data %>% subset(cntry == "Hungary")
d2 <- svydesign(ids = ~1, data = hundata, weights = hundata$dweights)
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
model_shame_hu <- svyglm(hmsfmlsh ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_shame_hu)
model_adoption_hu <- svyglm(hmsacld ~ agea + gndr + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_adoption_hu)
hundata <- hundata %>% subset(prtvtfhu %nin% c("Refusal", "Don't know", "Don't know"))
hundata <- hundata %>% subset(vote %nin% c("Refusal", "Don't know"))
d2 <- svydesign(ids = ~1, data = hundata, weights = hundata$dweights)
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
model_shame_hu <- svyglm(hmsfmlsh ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_shame_hu)
model_adoption_hu <- svyglm(hmsacld ~ agea + gndr + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_adoption_hu)
summary(model_free)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
model_shame <- svyglm(hmsfmlsh ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_shame)
model_shame <- svyglm(hmsfmlsh ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_shame)
cor(pol$stfgov, pol$stfdem) # 0.6774865 correlation
model_adoption <- svyglm(hmsacld ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem + adoption_law, design = d1)
summary(model_adoption)
model_adoption <- svyglm(hmsacld ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem + adoption_law, design = d1)
summary(model_adoption)
2+2
`%nin%` <- Negate(`%in%`)
ESS9 <- as.data.frame(read.spss("ESS9.sav"))
data <- ESS9 %>% select(agea,yrbrn,gndr,cntry,dweight,pweight,gincdif, eisced, domicil,
rlgblg, rlgatnd,
vote, prtvtfhu, lrscale,
stfgov, stfdem,
freehms,hmsfmlsh,hmsacld)
data$stfdem <-  recode(data$stfdem, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfdem <- as.numeric(as.character(data$stfdem))
data$stfgov <- recode(data$stfgov, "Extremely dissatisfied" ~ 0, 1~1,2~2,3~3,4~4,5~5,6~6,7~7,8~8,9~9,
"Extremely satisfied" ~ 10)
data$stfgov <- as.numeric(as.character(data$stfgov))
pol <- data %>% select(stfdem, stfgov) %>% na.omit()
cor(pol$stfgov, pol$stfdem) # 0.6774865 correlation
data$freehms <- recode(data$freehms, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsfmlsh <- recode(data$hmsfmlsh, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$hmsacld <- recode(data$hmsacld, "Agree strongly" ~ 1, "Agree"~2, "Neither agree nor disagree" ~ 3,
"Disagree" ~ 4, "Disagree strongly" ~ 5) %>% drop.levels(reorder = F) %>% as.character() %>% as.numeric()
data$agea <- data$agea %>% as.character() %>% as.numeric()
data$adoption_law <- factor(1, levels = c(1,2,3))
data$adoption_law[which(ESS9$cntry %in% c("Austria", "Germany", "Slovenia"))] <- 2
data$adoption_law[which(ESS9$cntry %in% c("Belgium","Denmark","Finland","France",
"Netherlands","Sweden"))] <- 3
data$adoption_law <- data$adoption_law %>% as.character() %>% as.numeric()
data <- data %>% subset(eisced %nin% c("Other", "Refusal", "Don't know", "No answer"))
data <- data %>% subset(domicil %nin% c("Refusal", "Don't know", "No answer"))
data <- data %>% subset(rlgatnd %nin% c("Refusal", "Don't know", "No answer"))
data <- data %>% subset(lrscale %nin% c("Refusal", "Don't know", "No answer"))
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
model_shame <- svyglm(hmsfmlsh ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_shame)
model_adoption <- svyglm(hmsacld ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem + adoption_law, design = d1)
summary(model_adoption)
hundata <- data %>% subset(cntry == "Hungary")
hundata <- hundata %>% subset(prtvtfhu %nin% c("Refusal", "Don't know", "Don't know"))
hundata <- hundata %>% subset(vote %nin% c("Refusal", "Don't know"))
d2 <- svydesign(ids = ~1, data = hundata, weights = hundata$dweights)
View(hundata)
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
which(hundata$vote == "Not wligible")
which(hundata$vote == "Not eligible to vote")
which(hundata$vote == "Not eligible to vote") %>% length()
model_shame_hu <- svyglm(hmsfmlsh ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_shame_hu)
which(hundata$vote) %>% length()
hundata$vote
which(hundata$vote %in% c("Yes", "no")) %>% length()
which(hundata$vote %in% c("Yes", "no")) %>% length()
which(hundata$vote %in% c("Yes")) %>% length()
which(hundata$vote %in% c("No")) %>% length()
which(hundata$vote %in% c("Yes", "No")) %>% length()
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
model_free_hu <- svyglm(freehms ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu , design = d1)
summary(model_free_hu)
model_shame_hu <- svyglm(hmsfmlsh ~ agea + gndr  + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu, design = d1)
summary(model_shame_hu)
d1 <- svydesign(ids = ~1, data = data, weights = ESS9$dweights)
model_free <- svyglm(freehms ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_free)
model_shame <- svyglm(hmsfmlsh ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem, design = d1)
summary(model_shame)
model_adoption <- svyglm(hmsacld ~ agea + gndr + cntry + eisced + domicil  + rlgatnd + lrscale + stfdem + adoption_law, design = d1)
summary(model_adoption) # Check adoption law
summary(model_free_hu)
summary(model_shame_hu)
summary(model_adoption_hu)
model_adoption_hu <- svyglm(hmsacld ~ agea + gndr + eisced + domicil  + rlgatnd + lrscale + stfdem + vote + prtvtfhu + adoption_law, design = d1)
summary(model_adoption_hu)
