scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = element_blank())
ggplot(data = filter(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 9) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = NULL)
ggplot(data = filter(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 9) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none")
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
variables
variable_labels <- list(
"ppltrst" = "\"Generally speaking, would you say that most people can be trusted, or that you can't be too careful in dealing with people? Please tell us on a score of 0 to 10, where 0 means you can't be too careful and 10 means that most people can be trusted.\"",
"pplfair" = "",
"pplhlp"  = "",
"trstprl" = "",
"trstep"  = "",
"trstlgl" = "",
"imbgeco" = "",
"imueclt" = "",
"imwbcnt" = "",
"impcntr" = "",
"imsmetn" = "",
"imdfetn" = "",
"happy"   = "",
"stflife" = "",
"frprtpl" = "",
"stfdem"  = "",
"stfeco"  = "",
"stfedu"  = "",
"stfhlth" = "",
"lrscale" = ""
)
variable_questions <- list(
"ppltrst" = "\"Generally speaking, would you say that most people can be trusted, or that you can't be too careful in dealing with people? Please tell us on a score of 0 to 10, where 0 means you can't be too careful and 10 means that most people can be trusted.\"",
"pplfair" = "",
"pplhlp"  = "",
"trstprl" = "",
"trstep"  = "",
"trstlgl" = "",
"imbgeco" = "",
"imueclt" = "",
"imwbcnt" = "",
"impcntr" = "",
"imsmetn" = "",
"imdfetn" = "",
"happy"   = "",
"stflife" = "",
"frprtpl" = "",
"stfdem"  = "",
"stfeco"  = "",
"stfedu"  = "",
"stfhlth" = "",
"lrscale" = ""
)
runApp()
runApp()
runApp()
runApp()
variables
varaible_limits <- list(
"ppltrst" <- c(0,10),
"pplfair" <- c(0,10),
"pplhlp"  <- c(0,10),
"trstprl" <- c(0,10),
"trstep"  <- c(0,10),
"trstlgl" <- c(0,10),
"imbgeco" <- c(0,10),
"imueclt" <- c(0,10),
"imwbcnt" <- c(0,10),
"impcntr" <- c(0,3),
"imsmetn" <- c(0,3),
"imdfetn" <- c(0,3),
"happy"   <- c(0,10),
"stflife" <- c(0,10),
"frprtpl" <- c(0,4),
"stfdem"  <- c(0,10),
"stfeco"  <- c(0,10),
"stfedu"  <- c(0,10),
"stfhlth" <- c(0,10),
"lrscale" <- c(0,10)
)
runApp()
varaible_limits <- list(
"ppltrst" <- c(0,10),
"pplfair" <- c(0,10),
"pplhlp"  <- c(0,10),
"trstprl" <- c(0,10),
"trstep"  <- c(0,10),
"trstlgl" <- c(0,10),
"imbgeco" <- c(0,10),
"imueclt" <- c(0,10),
"imwbcnt" <- c(0,10),
"impcntr" <- c(0,3),
"imsmetn" <- c(0,3),
"imdfetn" <- c(0,3),
"happy"   <- c(0,10),
"stflife" <- c(0,10),
"frprtpl" <- c(0,4),
"stfdem"  <- c(0,10),
"stfeco"  <- c(0,10),
"stfedu"  <- c(0,10),
"stfhlth" <- c(0,10),
"lrscale" <- c(0,10)
)
variable_limits <- list(
"ppltrst" <- c(0,10),
"pplfair" <- c(0,10),
"pplhlp"  <- c(0,10),
"trstprl" <- c(0,10),
"trstep"  <- c(0,10),
"trstlgl" <- c(0,10),
"imbgeco" <- c(0,10),
"imueclt" <- c(0,10),
"imwbcnt" <- c(0,10),
"impcntr" <- c(0,3),
"imsmetn" <- c(0,3),
"imdfetn" <- c(0,3),
"happy"   <- c(0,10),
"stflife" <- c(0,10),
"frprtpl" <- c(0,4),
"stfdem"  <- c(0,10),
"stfeco"  <- c(0,10),
"stfedu"  <- c(0,10),
"stfhlth" <- c(0,10),
"lrscale" <- c(0,10)
)
runApp()
variable_limits[[input$country_comparison_variable]] <- "ppltrst"
input$country_comparison_variable <- "ppltrst"
input <- list()
input$country_comparison_variable <- "ppltrst"
ggplot(data = filter(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") +
ylim(variable_limits[[input$country_comparison_variable]])
ggplot(data = filter(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") #+
subset(data, var == variable)
variable <- input$country_comparison_variable
data <- mean_data_long[which(mean_data_long$cntry %nin% c("PA", "EU")),]
data$cntry <- as.character(data$cntry)
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") #+
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") +
ylim(variable_limits[[input$country_comparison_variable]])
input$country_comparison_variable
variable_questions[[input$country_comparison_variable]]
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_limits[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") +
ylim(variable_limits[[input$country_comparison_variable]])
variable_limits
variable_limits[[input$country_comparison_variable]]
input$country_comparison_variable
variable_limits$ppltrst
variable_limits <- list(
ppltrst <- c(0,10),
pplfair <- c(0,10),
pplhlp  <- c(0,10),
trstprl <- c(0,10),
trstep  <- c(0,10),
trstlgl <- c(0,10),
imbgeco <- c(0,10),
imueclt <- c(0,10),
imwbcnt <- c(0,10),
impcntr <- c(0,3),
imsmetn <- c(0,3),
imdfetn <- c(0,3),
happy   <- c(0,10),
stflife <- c(0,10),
frprtpl <- c(0,4),
stfdem  <- c(0,10),
stfeco  <- c(0,10),
stfedu  <- c(0,10),
stfhlth <- c(0,10),
lrscale <- c(0,10)
)
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") +
ylim(variable_limits[[input$country_comparison_variable]])
input$country_comparison_variable
variable_limits$ppltrst
variable_limits <- list(
ppltrst = c(0,10),
pplfair = c(0,10),
pplhlp  = c(0,10),
trstprl = c(0,10),
trstep  = c(0,10),
trstlgl = c(0,10),
imbgeco = c(0,10),
imueclt = c(0,10),
imwbcnt = c(0,10),
impcntr = c(0,3),
imsmetn = c(0,3),
imdfetn = c(0,3),
happy   = c(0,10),
stflife = c(0,10),
frprtpl = c(0,4),
stfdem  = c(0,10),
stfeco  = c(0,10),
stfedu  = c(0,10),
stfhlth = c(0,10),
lrscale = c(0,10)
)
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses") +
ylim(variable_limits[[input$country_comparison_variable]])
runApp()
variable_limits[[input$country_comparison_variable]]
variable_limits[[input$country_comparison_variable]][2]
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
scale_y_continuous(breaks = seq(0, variable_limits[[input$country_comparison_variable]][2], by = 1)) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses")
runApp()
runApp()
ggplot(data = subset(data, var == variable), mapping = aes(x = reorder(cntry, value), y = value, fill = cntry)) +
geom_col() +
geom_flag(y = 0, aes(country = tolower(cntry)), size = 10) +
scale_fill_manual(values = list("AT" = "#646C64",
"BE" = "#74C19C",
"BG" = "#715865",
"CH" = "#9D8572",
"CY" = "#E6C65A",
"CZ" = "#B06E20",
"DE" = "#B4B4B4",
"EE" = "#CF765E",
"FI" = "#824914",
"FR" = "#0F1BBB",
"GB" = "#D20404",
"HU" = "#BB4646",
"IE" = "#067F02",
"IT" = "#84A259",
"NL" = "#F56414",
"NO" = "#AAAAD2",
"PL" = "#961717",
"RS" = "#71623D",
"SI" = "#93985E")) +
scale_y_continuous(
breaks = seq(0, variable_limits[[input$country_comparison_variable]][2], by = 1),
limits = variable_limits[[input$country_comparison_variable]]) +
theme(legend.position = "none",
plot.title = element_text(hjust = 0.5)) +
ggtitle(variable_questions[[input$country_comparison_variable]]) +
xlab("Country") +
ylab("Mean value of responses")
runApp()
deployApp()
deployApp()
